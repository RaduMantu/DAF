# CVE-2022-3602

More details on the vulnerability [here](https://nvd.nist.gov/vuln/detail/CVE-2022-3602).
Setup based on [this PoC](https://github.com/colmmacc/CVE-2022-3602).

## Build Image

```bash
# prepare certificates; parsing them will cause the error
$ ./prepare.sh

# build openssl w/ ASAN enabled by default
$ docker buildx build -t cve-2022-3602 .

# if you want to build w/o ASAN
# desirable for the client not to crash before sending the request
$ docker buildx build -t cve-2022-3602 --build-arg ASAN_EN='' .
```

## Start Container

```bash
# start a vulnerable server on a given port
$ docker run -ti cve-2022-3602 server 9001

# start a vulnerable client connecting to an ip:port
$ docker run -ti cve-2022-3602 client 172.17.0.1:9001

# start a shell (useful for debugging only)
$ docker run -ti cve-2022-3602
```

Objects that will be mapped in the address space of the `openssl` process will
be displayed alongside their SHA256 sums before the server / client starts.

Unless built with ASAN, chances are that the anomalous behaviour will pass
unnoticed.

